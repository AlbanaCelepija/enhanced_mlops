domain: PA
data_modality: tabular
ai_task: classification
ai_product_name: Time series Clustering
ai_product_description: This is a sklearn model which aims to classify whether or not an individual should be hired.
framework: local
operations:


####################################################### Evaluate if AI product can be reused for new use case
  - type: data_profiling  
    stage: data_preparation
    id: data_profiling_reuse
    name: Data profiling procedure to generate EDA report for production time series data characteristics
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec:
        path: data_preparation.py
        method_name: data_profiling_reuse
        requirements: requirements.txt
        inputs:
          - data:  ts_data_prod 
          - configuration: constraints_file    # total number, range of values, thresholds    
        outputs:
          - report: data_profiling_reuse_report

  - type: data_validation  
    stage: data_preparation
    id: compare_ts_profiling_reports
    name: Evaluate if target production data are drifted from training data 
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec: 
        path: data_preparation.py
        method_name: compare_ts_profiling_reports
        requirements: requirements.txt
        inputs:
          - data: ts_data_original
          - configuration: constraints_file    # range of values, thresholds       
        outputs:
          -  status: data_drift_status

####################################################### Data Preparation Stage
  - type: data_preprocessing  
    stage: data_preparation
    id: load_data
    name: Data preprocessing initial analysis 
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec:
        path: data_preparation.py
        method_name: load_data
        requirements: requirements.txt
        inputs:
          - data: ts_data_original
          - configuration: output_file  
        outputs:
          - data: ts_data_processed 

  - type: data_profiling  
    stage: data_preparation
    id: training_data_profiling
    name: Data profiling procedure to generate EDA report for time series data characteristics
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec:
        path: data_preparation.py
        method_name: training_data_profiling
        requirements: requirements.txt
        inputs:
          - data:  ts_data_prod 
          - configuration: constraints_file    # total number, range of values, thresholds    
        outputs:
          - report: training_data_profiling_report

  - type: data_validation  
    stage: data_preparation
    id: compare_ts_profiling_reports
    name: Training data validation to check data quality 
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec: 
        path: data_preparation.py
        method_name: compare_ts_profiling_reports
        requirements: requirements.txt
        inputs:
          - data: ts_data_original
          - configuration: constraints_file    # range of values, thresholds       
        outputs:
          -  status: data_drift_status
######################################################### Modelling Stage

  - type: model_training
    stage: modelling
    id: model_train
    name: Model Training 
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec:
        path: modelling.py
        method_name: fit_gaussian_mixture_model
        requirements: requirements.txt
        inputs:
          - data: ts_data_processed
          - configuration: model_train
        outputs:
          - model: model_clustering

# model evaluation 
  - type: model_evaluation
    stage: modelling
    id: model_evaluate_clustering
    name: Clustering Model Evaluation
    requirement_dimension: baseline
    implementation: 
      framework: local
      spec:
        path: modelling.py
        method_name: model_evaluation_clustering
        requirements: requirements.txt
        inputs:
          - data: ts_data_processed
          - model: model_clustering
          - configuration: model_train_config
        outputs:
          - report: model_metrics_report
####################################################### Operationalization Stage



##################################################### Artifacts
artifacts:
  data:
    - name: ts_data_original
      category: raw
      filepath: artifacts/data/recruitmentdataset-2022.csv
    - name: ts_data_detrended
      filepath: ts_data_detrended.parquet
  model:
    - name: model
      version: latest
      path: model_no_fair.pickle
  configuration:
    - name: output_file
      config:
        resulting_filepath: data_training.parquet
    - name: output_reweigh_file
      config:
        sensitive_features:
          - Ethnicity
          - Gender
        test_size: 0.3
        random_state: 4
        resulting_filepath: data_reweighed.parquet
    - name: model_train
      config:
        nr_clusters: 4
    - name: constraints_file
      config:
        constraints_filepath: artifacts/constraints.json
        min_training_data: 1000
  report:
    - name: data_report
      filepath: data_report.json    
    - name: model_metrics_report
      filepath: model_metrics_report.csv
    - name: model_acc_fairness_metrics_report
      filepath: model_acc_fairness_metrics_report.csv
  documentation:
    - name: data_card_hiring
      filepath: cards/data_card.md
    - name: model_card_hiring
      filepath: cards/model_card.md


